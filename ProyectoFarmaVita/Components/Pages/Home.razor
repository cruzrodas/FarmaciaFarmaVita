@page "/"
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@attribute [Authorize]
@inject AuthenticationStateProvider AuthProvider

<PageTitle>FarmaVita - Dashboard</PageTitle>

<MudContainer MaxWidth="MaxWidth.False" Class="mt-4">
    <MudGrid>
        <!-- Header de bienvenida simple -->
        <MudItem xs="12">
            <MudPaper Elevation="3" Class="pa-6 mb-4" Style="background: linear-gradient(135deg, #4CAF50 0%, #2E7D32 100%); color: white;">
                <MudGrid AlignItems="Center" Justify="Justify.Center">
                    <MudItem xs="12" Class="text-center">
                        <MudStack Spacing="2" AlignItems="AlignItems.Center">
                            <MudIcon Icon="@Icons.Material.Filled.LocalPharmacy" Size="Size.Large" Style="font-size: 4rem;" />
                            <MudText Typo="Typo.h3" Style="font-weight: 600;">
                                ¡Bienvenido a FarmaVita!
                            </MudText>
                            <AuthorizeView>
                                <Authorized>
                                    <MudText Typo="Typo.h5" Class="mt-2">
                                        Hola, <strong>@GetUserName()</strong>
                                    </MudText>
                                </Authorized>
                            </AuthorizeView>
                        </MudStack>
                    </MudItem>
                </MudGrid>
            </MudPaper>
        </MudItem>
    </MudGrid>
</MudContainer>

@code {
    private string GetUserName()
    {
        var authState = AuthProvider.GetAuthenticationStateAsync().Result;
        return authState.User.FindFirst("nombre")?.Value ??
               authState.User.Identity?.Name ??
               "Usuario";
    }
}