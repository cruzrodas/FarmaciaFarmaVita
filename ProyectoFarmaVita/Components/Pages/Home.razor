@page "/"

@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider

<MudPaper Class="p-4">
    <AuthorizeView>
        <Authorized>
            <MudText Typo="Typo.h5" Class="mt-2">
                Hola, <strong>@userName</strong>
            </MudText>
        </Authorized>
        <NotAuthorized>
            <MudText Typo="Typo.h6" Class="mt-2">
                No has iniciado sesión.
            </MudText>
        </NotAuthorized>
    </AuthorizeView>
</MudPaper>

@code {
    private string userName = "Usuario";

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        // Obtener el nombre del claim "nombre", si no existe usar Identity.Name
        userName = user.FindFirst("nombre")?.Value ?? user.Identity?.Name ?? "Usuario";
    }
}
